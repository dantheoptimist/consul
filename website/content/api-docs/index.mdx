---
layout: api
page_title: HTTP API
description: |-
  Consul exposes a RESTful HTTP API to control almost every aspect of the
  Consul agent.
---

# HTTP API Structure

The main interface to Consul is a RESTful HTTP API. The API can perform basic
CRUD operations on nodes, services, checks, configuration, and more.

## Authentication

When authentication is enabled, a Consul token should be provided to API
requests using the `X-Consul-Token` header or with the
Bearer scheme in the authorization header.
This reduces the probability of the
token accidentally getting logged or exposed. When using authentication,
clients should communicate via TLS. If you donâ€™t provide a token in the request, then the agent default token will be used.

Below is an example using `curl` with `X-Consul-Token`.

```shell-session
$ curl \
    --header "X-Consul-Token: <consul token>" \
    http://127.0.0.1:8500/v1/agent/members
```

Below is an example using `curl` with Bearer scheme.

```shell-session
$ curl \
    --header "Authorization: Bearer <consul token>" \
    http://127.0.0.1:8500/v1/agent/members
```

Previously this was provided via a `?token=` query parameter. This functionality
exists on many endpoints for backwards compatibility, but its use is **highly
discouraged**, since it can show up in access logs as part of the URL.

To learn more about the ACL system read the [documentation](/docs/acl/acl-system).

## Version Prefix

All API routes are prefixed with `/v1/`. This documentation is only for the v1 API.

## Formatted JSON Output

By default, the output of all HTTP API requests is minimized JSON. If the client
passes `pretty` on the query string, formatted JSON will be returned.

## HTTP Methods

Consul's API aims to be RESTful, although there are some exceptions. The API
responds to the standard HTTP verbs GET, PUT, and DELETE. Each API method will
clearly document the verb(s) it responds to and the generated response. The same
path with different verbs may trigger different behavior. For example:

```text
PUT /v1/kv/foo
GET /v1/kv/foo
```

Even though these share a path, the `PUT` operation creates a new key whereas
the `GET` operation reads an existing key.

Here is the same example using `curl`:

```shell-session
$ curl \
    --request PUT \
    --data 'hello consul' \
    http://127.0.0.1:8500/v1/kv/foo
```

## Tagged Addresses

Tagged addresses are additional addresses which may be defined for a node or
service. Tagged addresses can be used by remote agents and services as alternative
addresses for communicating with the given node or service. Multiple tagged
addresses address may be configured on a node or service.

The syntax for defining a tagged address is as follows.

<CodeTabs heading="Tagged address format">

```hcl
service {
  name = "redis"
  port = 80
  tagged_addresses {
    <tag> = {
      address = "<address>"
      port = port
    }
  }
}
```

```json
{
  "service": {
    "name": "redis",
    "port": 80,
    "tagged_addresses": {
      "<tag>": {
        "address": "<address>",
        "port": port
      }
    }
  }
}
```

</CodeTabs>

Consul supports several tagged address types. The various types and their use
cases are detailed below.

### LAN

LAN addresses are intended to be directly accessible only from services within
the same Consul data center.

#### Supported tags

* `lan` - The IPv4 LAN address at which the node or service is accessible.
* `lan_ipv4` - The IPv4 LAN address at which the node or service is accessible.
* `lan_ipv6` - The IPv6 LAN address at which the node or service is accessible.

<CodeTabs heading="Example LAN tagged address configuration">

<CodeBlockConfig filename="redis-service.hcl">

```hcl
service {
  name = "redis"
  address = "192.0.2.10"
  port = 80
  tagged_addresses {
    lan = {
      address = "192.0.2.10"
      port = 80
    }
    lan_ipv4 = {
      address = "192.0.2.10"
      port = 80
    }
    lan_ipv6 = {
      address = "2001:db8:1:2:cafe::1337"
      port = 80
    }
  }
}
```

</CodeBlockConfig>

<CodeBlockConfig filename="redis-service.json">

```json
{
  "service": {
    "name": "redis",
    "address": "192.0.2.10",
    "port": 80,
    "tagged_addresses": {
      "lan": {
        "address": "192.0.2.10",
        "port": 80
      },
      "lan_ipv4": {
        "address": "192.0.2.10",
        "port": 80
      },
      "lan_ipv6": {
        "address": "2001:db8:1:2:cafe::1337",
        "port": 80
      }
    }
  }
}
```

</CodeBlockConfig>
</CodeTabs>

### Virtual

Virtual tagged addresses are a logical address type which is used by
[Connect](/docs/connect) to route traffic to the associated destination service
in the service mesh when:

1. [Transparent proxy](/docs/connect/transparent-proxy) is enabled.
1. The service is not configured for individual instances to be
   [dialed directly](/docs/connect/config-entries/service-defaults#dialeddirectly).

-> **Note**: Virtual addresses are not required to be routable IPs within the
network. They are strictly a control plane construct used to provide a single
address for the instances of a given logical service.

#### Supported tags

The following address tag can be configured for a service to advertise the
logical address to be used to dial it over the service mesh.

- `virtual` - The virtual IP address at which a logical service is reachable.

<CodeTabs heading="Example virtual tagged address configuration">

<CodeBlockConfig filename="redis-service.hcl">

```hcl
service {
  name = "redis"
  address = "192.0.2.10"
  port = 80
  tagged_addresses {
    virtual = {
      address = "203.0.113.50"
      port = 80
    }
  }
}
```

</CodeBlockConfig>

<CodeBlockConfig filename="redis-service.json">

```json
{
  "service": {
    "name": "redis",
    "address": "192.0.2.10",
    "port": 80,
    "tagged_addresses": {
      "virtual": {
        "address": "203.0.113.50",
        "port": 80
      }
    }
  }
}
```

</CodeBlockConfig>
</CodeTabs>

### WAN

These addresses are intended to be accessible only when dialing a node or service
from a remote WAN federated data center.

#### Supported tags

One or more of the following address tags can be configured for a node or service
to advertise how it should be accessed over the WAN.

- `wan` - The IPv4 WAN address at which the node or service is accessible when
  being dialed from a remote data center.
- `wan_ipv4` - The IPv4 WAN address at which the node or service is accessible
  when being dialed from a remote data center.
- `wan_ipv6` - The IPv6 WAN address at which the node or service is accessible
  when being dialed from a remote data center.

<CodeTabs heading="Example WAN tagged address configuration">

<CodeBlockConfig filename="redis-service.hcl">

```hcl
service {
  name = "redis"
  address = "192.0.2.10"
  port = 80
  tagged_addresses {
    wan = {
      address = "198.51.100.200"
      port = 80
    }
    wan_ipv4 = {
      address = "198.51.100.200"
      port = 80
    }
    wan_ipv6 = {
      address = "2001:db8:5:6:1337::1eaf"
      port = 80
    }
  }
}
```

</CodeBlockConfig>

<CodeBlockConfig filename="redis-service.json">

```json
{
  "service": {
    "name": "redis",
    "address": "192.0.2.10",
    "port": 80,
    "tagged_addresses": {
      "wan": {
        "address": "198.51.100.200",
        "port": 80
      },
      "wan_ipv4": {
        "address": "198.51.100.200",
        "port": 80
      },
      "wan_ipv6": {
        "address": "2001:db8:5:6:1337::1eaf",
        "port": 80
      }
    }
  }
}
```

</CodeBlockConfig>
</CodeTabs>

## Translated Addresses

Consul 0.7 added the ability to translate addresses in HTTP response based on
the configuration setting for
[`translate_wan_addrs`](/docs/agent/options#translate_wan_addrs). In order
to allow clients to know if address translation is in effect, the
`X-Consul-Translate-Addresses` header will be added if translation is enabled,
and will have a value of `true`. If translation is not enabled then this header
will not be present.

## Default ACL Policy

All API responses for Consul versions after 1.9 will include an HTTP response
header `X-Consul-Default-ACL-Policy` set to either "allow" or "deny" which
mirrors the current value of the agent's
[`acl.default_policy`](/docs/agent/options#acl_default_policy) option.

This is also the default [intention](/docs/connect/intentions) enforcement
action if no intention matches.

This is returned even if ACLs are disabled.

## UUID Format

UUID-format identifiers generated by the Consul API use the
[hashicorp/go-uuid](https://github.com/hashicorp/go-uuid) library.

These UUID-format strings are generated using high quality, purely random bytes.
It is not intended to be RFC compliant, merely to use a well-understood string
representation of a 128-bit value.
